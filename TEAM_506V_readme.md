## 제 3회 AI SPARK 챌린지
### **팀 506V 코드 설명**
- AI 서비스 / 아이디어 명 : 루시(Rucy, Report yoUr pet’s Condition dailY) <br>
- 서비스 핵심 내용 : ETRI 나눔 AI 플랫폼 내 ‘강아지 정상 비만 판별을 위한 이미지 데이터’와 ‘강아지 고양이 피부병 이미지 데이터’를 활용한 반려견, 반려묘 건강 관리 알고리즘 개발 <br>

1. **사용 데이터 셋 : ETRI AI 나눔 데이터 셋**
> **0) 기획안에 기재된 데이터 셋 : “강아지 정상 비만 판별을 위한 이미지 데이터”, “강아지, 고양이 피부병 이미지 데이터”** <br>
> - 기획안에서 계획한 2가지 데이터 모두 데이터 재구성 후 사용하였음. <br><br>
> **1) “강아지 정상 비만 판별을 위한 이미지 데이터” <br>**
> - https://nanum.etri.re.kr/share/1st9aram/dogover?lang=ko_KR <br>
> - 데이터 정제 전 : 정상(1) 969개, 비만(2) 215개의 이미지로 구성되어 있음. <br>
> - 데이터 정제 후 : 저체중(0) 348개, 정상(1) 1050개, 비만(2) 256개의 이미지로 재구성. <br>
> - 웹 크롤링, 수작업을 통한 데이터 정제를 한 후에도 데이터 불균형 문제를 띄고 있어, Data Agumentation(데이터 증강)과 클래스 가중치를 통해 해결 하였음. <br><br>
> **2) “강아지, 고양이 피부병 이미지 데이터” <br>**
> - https://nanum.etri.re.kr/share/1st9aram/dogcatskindisease?lang=ko_KR <br>
> - 데이터 정제 전 : Germ_c 세균감염(3) 622개, helminth_c 기생충(4) 85개, mold_c 곰팡이(5) 241로 구성되어 있음.<br>
> - 데이터 불균형의 문제를 Data Augmentation(데이터 증강)과 클래스 가중치를 사용하여 해결하였음.<br>

2. **알고리즘 설명**
> **0) 기획 단계**
> - 직접 구성한 CNN모델과 VGG, ResNet과 Vit모델을  Tranfer Learning하여 나온 결과를 비교 분석해본 후 높은 성능을 달성한 모델을 채택하기로 계획하였음. <br>
> - 우리의 데이터셋에 좋은 성능을 거둔 모델을 채택한 후 하이퍼파라미터 튜닝을 통해 모델 최적화를 계획하였음. <br><br>
> **1) 모델 성능 비교**
> - 강아지/고양이 비만도와 피부 질환 데이터 셋 분류에 높은 성능을 보이는 모델을 채택하기 위해 여러 모델들의 성능을 비교해보았음. <br>
> - (1) CNN <br>
> - 데이터 셋의 크기가 크지 않으므로 직접 구성한 CNN에 먼저 모델 학습을 진행해보았음. <br>
> - 비만도 정확도는 72%, 피부질환 정확도는 70%정도 나왔으며, 하이퍼 파라미터 튜닝을 해보면서 성능 업그레이드를 해보았으나, 성능이 1%이상 향상되지 않았음. <br>
> - (2) VGG16 <br>
> - MB 크기의 VGG16 모델을 tranfer learning하여 모델 학습을 진행해보았음. <br>
> - 비만도 정확도는 76%, 피부질환 정확도는 72%정도 나왔으며, 하이퍼 파라미터 튜닝을 해보면서 성능 업그레이드를 해보았으나, 성능이 2%이상 향상되지 않았음. <br>
> - (3) ResNet50 <br>
> - MB 크기의 ResNet50 모델을 tranfer learning하여 모델 학습을 진행해보았음. <br>
> - 비만도 정확도는 79%, 피부질환 정확도는 73%정도 나왔으며, 하이퍼 파라미터 튜닝을 해보면서 성능 업그레이드를 해보았으나, 성능이 1%이상 향상되지 않았음. <br>
> - (4) EfficentNetV2 <br>
> - MB 크기의 EfficientNetV2 모델을 tranfer learning하여 모델 학습을 진행해보았음. <br>
> - 비만도 정확도는 81%, 피부질환 정확도는 75%정도 나왔으며, 하이퍼 파라미터 튜닝을 해보면서 성능 업그레이드를 해보았으나, 성능이 1%이상 향상되지 않았음. <br>
> - (5) ViT<br>
> - MB 크기의 ViT 모델을 tranfer learning하여 모델 학습을 진행해보았음. <br>
> - 비만도 정확도는 84.9%, 피부질환 정확도는 80%정도 나왔으며, 하이퍼 파라미터 튜닝을 해보면서 성능 업그레이드를 해보았으나, 성능이 3%이상 향상되었음. <br><br>
> **2) 모델 채택 및 하이퍼파라미터 튜닝**
> - 다양한 모델 성능 비교를 통해 높은 성능을 거둔 **ViT 모델을 채택**하여 학습을 진행하였음.<br>
> - 채택된 모델의 성능 개선과 비만도와 피부병 데이터 사이의 성능 차이를 줄이고자 하이퍼 파라미터 튜닝을 진행하였음.<br>
> - 하이퍼 파라미터 튜닝을 통해 1% 이상의 성능 개선을 하였음.<br><br>

3. **평가 메트릭**
> - accuracy를 평가 지표로 비만도 3개의 클래스와 피부병 3개의 클래스를 각각 추론했음.  <br>
> - 추론을 통한 각 각 입력 이미지의 label을 예측하고, 예측 결과를 합쳐서 정확도를 도출했음.<br>
> - 최종적으로 약 83% accuracy를 얻었음.<br>
